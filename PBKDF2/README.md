# The Password-Based Key Derivation Function #2 (PBKDF2)

This section includes the implementation of the PBKDF2 in Base SAS, for deriving keys, given a password and a salt. An implementation in SAS of the PBKDF2 algorithm is provided, which derives a key, once given a password, a cryptographic salt, a pseudorandom function to use internally, a number of rounds to be performed internally, and the desired derived key length.

The Password-Based Key Derivation Function #2 (PBKDF2) specification can be found [here](https://datatracker.ietf.org/doc/html/rfc8018#section-5.2).

The implementation is 100% Base SAS, without the need of using other languages.

## Installation

### Step 1: Hexadecimal utility functions

Execute all the files under [Crypto-SAS/Hexadecimal](https://github.com/AlexBennasar/Crypto-SAS/tree/main/Hexadecimal). This will load several macros needed.

### Step2: PBKDF2 algorithm and F function

Execute all the files contained in this folder. This will load 2 macros needed: the basic PBKDF2 algorithm and the F function, defined in the standard.

## Usage

To derive a key, call this macro:

```SAS
%macro PBKDF2
   (password           /* Secret password for generating the key */
   ,salt               /* Octet string that combines with password to produce a key */
   ,iCount             /* Number of iterations to perform inside the F function */
   ,PRF                /* Pseudorandom function to apply */
   ,derivedKeyLength   /* Desired length, in octets, of the key produced */
   );
```

- password is a secret string, from which cryptographic keys will be derived.
- salt is an octet random string of an arbitrary length that lets the user, by specifying different salts in different execution of the macro, to derive several keys given one unique password. Please refer to the [PKCS #5 standard](https://datatracker.ietf.org/doc/html/rfc8018#section-4.1) for more details and recommendations for selecting the salt.
- iCount is the number of iterations to be performed to derive the key, the bigger the better from a security point of view, but always with care, as a bigger iCount, worst performance (more time) for deriving the key. Please refer to the [PKCS #5 standard](https://datatracker.ietf.org/doc/html/rfc8018#section-4.2) for more details and recommendations for selecting the iteration count.
- PRF is the pseudorandom function to apply internally to the password and the salt to derive the key. This implementation only supports, for now, the [HMAC-SHA256 algorithm] (https://en.wikipedia.org/wiki/HMAC), so this parameter must be HMAC-SHA256.
- derivedKeyLength will be the length, in bytes, of the key generated by the macro.

## Examples of use

[Crypto-SAS/PBKDF2/Test](hhttps://github.com/AlexBennasar/Crypto-SAS/tree/main/PBKDF2/Test) contains an usage example of the macro.

## Testing
All the code developed has been tested in SAS Studio, release 3.8 (SAS release: 9.04.01M6P11072018).